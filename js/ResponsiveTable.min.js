(function(h,f,a){"undefined"!==typeof module?module.exports=a(h,f):"function"===typeof define&&"object"===typeof define.amd?define(a):f[h]=a(h,f)})("ResponsiveTable",this,function(h,f){return new Class({Implements:[Options,Events],options:{classes:{enhanced:"enhanced",persist:"persist",colHidden:"col-hidden",colVisible:"col-visible"},displayMenu:{linkText:"Display columns",position:"top"},checkInputEvents:["orientationchange","resize"]},initialize:function(a,b){this.setOptions(b);this.table=document.getElement(a);
this.table.addClass(this.options.classes.enhanced);this.container=(new Element("div.responsive-table-container")).wraps(this.table);this.displayMenu=this.createDisplayMenu();this.associateColumns();this.displayMenu.inject(this.container,this.options.displayMenu.position);this.checkboxes=this.displayMenu.getElements("input");this.setInputState();this.attachCheckInputEvents()},setInputState:function(){this.checkboxes.each(function(a){var b="table-cell"===a.retrieve("th").getStyle("display")?!0:!1;a.set("checked",
b)});this.fireEvent("checkInputState",[this.checkboxes])},attachCheckInputEvents:function(){var a=this.options.checkInputEvents,b=this.setInputState.bind(this);"string"===typeof a&&(a=[a]);for(var c=0,d=a.length;c<d;c++)f.addEvent(a[c],b)}.protect(),associateColumns:function(){var a=this.table;a.getElements("thead th").each(function(b,c){var d,g=new Elements,e=c+1;b.addClass("column-"+e);d=b.get("class");a.getElements("tbody tr").each(function(a){a=a.getElements("th, td");a[c].addClass(d);g.push(a[c])});
b.store("column",g);this.createColumnToggle(b,e)},this)}.protect(),createColumnToggle:function(a,b){if(!a.hasClass(this.options.classes.persist)){var c=this.options,d=new Element("li.display-list-item"),g=new Element("label",{text:a.get("text"),"for":"display-checkbox-"+b,onclick:""}),e=new Element("input",{type:"checkbox","class":"display-checkbox",checked:!0,id:"display-checkbox-"+b});e.store("th",a);e.addEvent("change",function(){var b=a.retrieve("column"),d=this.get("checked")?[c.classes.colHidden,
c.classes.colVisible]:[c.classes.colVisible,c.classes.colHidden];[a,b].each(function(a){a.swapClass(d[0],d[1])})});g.grab(e,"top");d.grab(g).inject(this.displayMenu.getElement("ul"))}}.protect(),createDisplayMenu:function(){var a=this,b=new Element("div.display-menu"),c=new Element("ul.display-list"),d=new Element("a",{text:this.options.displayMenu.linkText,"class":"display-link",href:"#",events:{click:function(b){c.toggle();a.fireEvent("displayMenuToggle",[b,this]);b.preventDefault()}}});return b.adopt(d,
c)}.protect()})});
